Refactored context layer to be independent of click.
